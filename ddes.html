<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Messages - LearnHub</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #0ea5e9, #1e293b);
  color: #fff;
  margin: 0;
  padding: 0;
}
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  background: rgba(0,0,0,0.4);
}
header h1 { font-size: 1.8rem; color: #38bdf8; }
header button {
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  background: #22c55e;
  color: #fff;
  cursor: pointer;
}

.container { max-width: 800px; margin: 20px auto; padding: 0 15px; }
.card { background: rgba(0,0,0,0.3); padding: 20px; border-radius: 12px; }
.messages { max-height: 400px; overflow-y: auto; background: rgba(0,0,0,0.15); padding: 15px; border-radius: 10px; }
.msg { padding: 10px 15px; border-radius: 10px; margin-bottom: 12px; max-width: 80%; }
.msg.admin { background: #0ea5e9; float: left; text-align: left; }
.msg.student { background: #22c55e; float: right; text-align: right; }
.msg small { display: block; font-size: 0.75rem; margin-top: 4px; color: #e2e8f0; }
.clearfix { clear: both; }
</style>
</head>
<body>

<header>
  <h1>Welcome, <span id="studentName">Student</span></h1>
  <button id="logoutBtn">Logout</button>
</header>

<div class="container">
  <div class="card">
    <h2>Messages from Admin</h2>
    <div class="messages" id="chatMessages"></div>
  </div>
</div>

<script>
// ===== Current User =====
const currentUser = localStorage.getItem('currentUser');
const studentData = JSON.parse(localStorage.getItem('user_' + currentUser));
const studentName = studentData?.name || currentUser;
document.getElementById('studentName').textContent = studentName;

// ===== Logout =====
document.getElementById('logoutBtn').addEventListener('click', () => {
  localStorage.removeItem('currentUser');
  window.location.href = 'login.html';
});

// ===== Admin Messages =====
function renderMessages() {
  const chatMessages = document.getElementById('chatMessages');
  // Only get messages for this student
  const messages = JSON.parse(localStorage.getItem('messages_' + currentUser) || '[]');
  chatMessages.innerHTML = '';
  messages.forEach(m => {
    const div = document.createElement('div');
    div.classList.add('msg', m.from === 'Admin' ? 'admin' : 'student');
    div.innerHTML = `<p>${m.text}</p><small>${m.from} â€¢ ${new Date(m.ts).toLocaleString()}</small>`;
    chatMessages.appendChild(div);
    chatMessages.appendChild(document.createElement('div')).className='clearfix';
  });
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

renderMessages();
</script>

</body>
</html>
