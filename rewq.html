<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Dashboard - LearnHub</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
  font-family:'Poppins',sans-serif;
  background: linear-gradient(135deg,#0ea5e9,#1e293b);
  color:#fff;
  margin:0;
  padding:0;
}
header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 20px;
  background:rgba(0,0,0,0.4);
}
header h1 {font-size:1.8rem;color:#38bdf8;}
header button {
  padding:8px 12px;
  border:none;
  border-radius:8px;
  background:#22c55e;
  color:#fff;
  cursor:pointer;
}
nav {
  display:flex;
  justify-content:center;
  background:rgba(0,0,0,0.3);
}
nav button {
  background:transparent;
  border:none;
  color:#fff;
  padding:12px 20px;
  cursor:pointer;
  font-weight:600;
  transition:0.3s;
}
nav button.active, nav button:hover {background:rgba(0,0,0,0.5);border-radius:8px;}
.container {max-width:1100px;margin:20px auto;padding:0 15px;}
.section {display:none;}
.section.active {display:block;}
.card {background:rgba(0,0,0,0.25);padding:20px;border-radius:12px;margin-bottom:20px;}
.messages, .event-list {max-height:400px;overflow:auto;margin-top:15px;border-radius:10px;background:rgba(0,0,0,0.15);padding:15px;}
.msg {padding:10px 15px;border-radius:10px;margin-bottom:12px;max-width:70%;clear:both;}
.msg.admin{background:#0ea5e9; float:left;}
.msg.student{background:#22c55e; float:right;}
.msg small{display:block;font-size:0.75rem;margin-top:4px;color:#e2e8f0;}
.input-area{display:flex;gap:10px;margin-top:10px;}
.input-area input{flex:1;padding:10px;border-radius:8px;border:none;}
.input-area button{padding:10px 15px;border:none;border-radius:8px;background:#0ea5e9;color:#fff;cursor:pointer;font-weight:600;}
.input-area button:hover{background:#38bdf8;}
.register-btn {padding:8px 12px;background:#0ea5e9;color:#fff;border:none;border-radius:6px;cursor:pointer;}
.register-btn.registered {background:#22c55e;cursor:default;}
</style>
</head>
<body>

<header>
  <h1>Student Dashboard</h1>
  <button id="logoutBtn">Logout</button>
</header>

<nav>
  <button class="nav-btn active" data-section="messagesSection">Messages</button>
  <button class="nav-btn" data-section="eventsSection">Upcoming Tests</button>
</nav>

<div class="container">
  <!-- Messages -->
  <div class="section active" id="messagesSection">
    <div class="card">
      <h2>Messages from Admin</h2>
      <div class="messages" id="chatMessages"></div>
    </div>
  </div>

  <!-- Events -->
  <div class="section" id="eventsSection">
    <div class="card">
      <h2>Upcoming Tests & Registration</h2>
      <div class="event-list" id="eventList"></div>
    </div>
  </div>
</div>

<script>
// ===== Navigation =====
const navButtons = document.querySelectorAll('.nav-btn');
const sections = document.querySelectorAll('.section');
navButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    navButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    sections.forEach(sec=>sec.classList.remove('active'));
    document.getElementById(btn.dataset.section).classList.add('active');
  });
});

// ===== Logout =====
document.getElementById('logoutBtn').addEventListener('click', ()=>{
  localStorage.removeItem('currentUser');
  window.location.href='login.html';
});

// ===== Current User =====
const currentUser = localStorage.getItem('currentUser');
if(!currentUser) window.location.href='login.html';
const displayName = JSON.parse(localStorage.getItem('user_' + currentUser))?.name || currentUser;

// ===== Messages =====
const chatMessages = document.getElementById('chatMessages');
function renderMessages(){
  const messages = JSON.parse(localStorage.getItem('messages_' + currentUser) || '[]');
  chatMessages.innerHTML = '';
  if(messages.length===0){
    chatMessages.innerHTML='<p style="text-align:center;color:#cbd5e1">No messages from admin.</p>';
    return;
  }
  messages.forEach(m=>{
    const div = document.createElement('div');
    div.classList.add('msg', m.from==="Admin"?"admin":"student");
    div.innerHTML=`<p>${m.text}</p><small>${m.from} â€¢ ${new Date(m.ts).toLocaleString()}</small>`;
    chatMessages.appendChild(div);
  });
  chatMessages.scrollTop = chatMessages.scrollHeight;
}
renderMessages();

// ===== Events =====
let events = JSON.parse(localStorage.getItem('events')) || [
